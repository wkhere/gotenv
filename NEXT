+ bug#1: for two lines with the same key, first one is used

- error messages instead of "invalid state x"

- bug#2: dedup works only within one input file, should work across many files
